function disableCopying(){$(document).on({contextmenu:function(){return!1},copy:function(){return!1}})}function createQuestions(){for(var e="",t="",s="",i=JSON.parse(quiz.questions),o=0;o<i.length;o+=1)e+="<div class='bg-inner questionContainer "+o+"'>",e+="	<div class='col-xs-12 bg-info'>",e+="		<div class='bg-data-ques'>",e+="			<div class='wow fadeInLeft question col-xs-10 col-xs-push-1' data-wow-delay='.5s'>",e+="				<p>"+(o+1)+": <span>"+i[o][0]+"</span></p>",e+="			</div>",e+="		</div>",e+="	</div>",e+="	<div class='col-md-12 col-lg-12 col-sm-12 col-xs-12'>",e+="		<div class='col-md-5 col-lg-5 col-sm-5 col-xs-12 bg-info'>",e+="                <div class='bg-data-ans'>",e+="					<div class='wow fadeInLeft answer 0 col-xs-10 col-xs-push-1' onclick='selectAnswer(0)' data-wow-delay='1s'>",e+="						<p>A: <span>"+i[o][1][0]+"</span></p>",e+="					</div>",e+="                </div>",e+="                <div class='bg-data-ans'>",e+="					<div class='wow fadeInLeft answer 1 col-xs-10 col-xs-push-1' onclick='selectAnswer(1)' data-wow-delay='1.5s'>",e+="						<p>B: <span>"+i[o][1][1]+"</span></p>",e+="					</div>",e+="                </div>",e+="		</div>",e+="        <div class='col-md-2 col-lg-2 col-sm-2 col-xs-12' style='padding:0;'>",e+="            <div class=' bg-timer'>",e+="                <div class='wow fadeInLeft' data-wow-delay='3s'>",e+="                    <span class='timer'></span>",e+="                </div>",e+="            </div>",e+="        </div>",e+="		<div class='col-md-5 col-lg-5 col-sm-5 col-xs-12 bg-info'>",e+="                <div class='bg-data-ans'>",e+="					<div class='wow fadeInLeft answer 2 col-xs-10 col-xs-push-1' onclick='selectAnswer(2)' data-wow-delay='2s'>",e+="						<p>C: <span>"+i[o][1][2]+"</span></p>",e+="					</div>",e+="                </div>",e+="                <div class='bg-data-ans'>",e+="					<div class='wow fadeInLeft answer 3 col-xs-10 col-xs-push-1' onclick='selectAnswer(3)' data-wow-delay='2.5s'>",e+="						<p>D: <span>"+i[o][1][3]+"</span></p>",e+="					</div>",e+="                </div>",e+="		</div>",e+="	</div>",e+="</div>",t+="<div class='col-md-12 col-lg-12 col-sm-12 col-xs-12 footer-button "+o+"'>",t+="    <div class='col-md-6 col-lg-6 col-sm-6 col-xs-6'>",0!==o&&(t+="        <div class='footer-button-bck'  onclick='previousQuestion("+o+")'></div>"),t+="	   </div>",t+="	   <div class='col-md-6 col-lg-6 col-sm-6 col-xs-6'>",t+="        <div class='footer-button-nxt'  onclick='nextQuestion("+o+")'></div>",t+="	   </div>",t+="</div>",s+="<div class='questionButton "+o+" col-xs-3 col-sm-4'>",s+="    <button onclick='goToQuestion("+o+")'>"+(o+1)+"</button>",s+="</div>";e+="<div class='bg-inner questionContainer "+i.length+"'>",e+="    <button class='btn btn-default submitAnswersButtonCenter' onclick='submitAnswers()'>End Quiz and Submit Answers</button>",e+="</div>",$("#submitQuizContainer").empty().append("<button class='btn btn-default submitAnswersButtonHeader' onclick='submitAnswers()'>End Quiz and<br />Submit Answers</button>"),$("#questionsContainer").empty().append(e),$("#quizFooter").empty().append(t),$("#questionList").empty().append(s)}function startQuiz(){$("#countdown").hide(),$("#questionsContainer").show(),$("#quizFooter").show(),$(".footer-button.0").show(),$(".questionContainer.0").addClass("currentQuestion"),startQuizTime=moment(),1==quiz.quizID||2==quiz.quizID?$(".timer").hide():updateCountdownTimers(),timeLeftTimer=setInterval(updateCountdownTimers,1e3)}function submitAnswers(){for(var e=[],t=0;t<answersGiven.length;t+=1)-1==answersGiven[t]&&e.push(t+1);e.length>0?confirm("You haven't answered questions "+e.join(", ")+". Do you still want to end the quiz and submit your answers?")&&endQuiz():endQuiz()}function endQuiz(){$("#questionsContainer").hide(),$("#questionList > *").hide(),$(".submitAnswersButtonHeader").hide(),clearTimeout(endTimer),clearTimeout(timeLeftTimer),endQuizTime=moment();for(var e=0,t=JSON.parse(quiz.questions),s=[],i=0;i<t.length;i+=1){var o=[[t[i][0]],[t[i][1][answersGiven[i]],answersGiven[i]]];t[i][2]==answersGiven[i]?(e+=1,o.push("correct")):o.push("incorrect"),s.push(o)}var n=Math.ceil(endQuizTime.diff(startQuizTime)),a=Math.ceil(100*e/t.length);1==quiz.quizID||2==quiz.quizID?showResultsPage(e,a,n,t.length):$.post("./php/quizresults/uploadquizresult.php",{quizID:quiz.quizID,userID:sessionStorage.userID,username:sessionStorage.username,timeTaken:n,questions:s,correctPercent:a},function(s){"success"==s?showResultsPage(e,a,n,t.length):displayMessage("error","Error","Error uploading your results. Contact the web admin for details on what to do. "+s)}).fail(function(){displayMessage("warning","Results Not Uploaded","There was a problem uploading your quiz results. Please check that you have a working internet connection. You will have 1 minute or until the quiz ends (whichever is less) to reconnect at which point your results will be uploaded. The results can be uploaded from any quizeto.com webpage. If your internet connect is working, then contact the web admin to inform them of this problem"),localStorage.quizResults=JSON.stringify({quizID:quiz.quizID,userID:sessionStorage.userID,username:sessionStorage.username,timeTaken:n,questions:s,correctPercent:a,currentTime:moment(),quizEndTime:quiz.endTime,quizType:quiz.type}),window.location="index.php"})}function showResultsPage(e,t,s,i){$("#quizFooter").hide();1==quiz.quizID||2==quiz.quizID?$("#resultText").text("You got "+e+" out of "+i+" correct."):"free"==quiz.type?$.post("./php/users/depositfreepoints.php",{userID:sessionStorage.userID,correctPercent:t},function(s){if("success"==s){var o;o=100==t?5:t>=90?4:t>=80?3:0,$("#resultText").text("You got "+e+" out of "+i+" correct. "+o+" bonus quizetos have been added to your account.")}else displayMessage("error","Error","Error depositing your bonus quizetos in your account."),$("#resultText").text("You got "+e+" out of "+i+" correct.")}).fail(function(){}):$("#resultText").text("You got "+e+" out of "+i+" correct."),$("#quizResults").show()}function selectAnswer(e){selectedAnswer=e,$(".selectedAnswer").removeClass("selectedAnswer"),$(".answer."+e).parent().addClass("selectedAnswer")}function nextQuestion(e){answersGiven[e]=selectedAnswer,selectedAnswer=-1,$(".selectedAnswer").removeClass("selectedAnswer"),$(".questionContainer."+e).removeClass("currentQuestion"),$(".questionContainer."+(e+1)).addClass("currentQuestion"),$(".footer-button."+e).hide(),$(".footer-button."+(e+1)).show(),currentQuestion+=1,updateQuizFooterQuestionColours(),selectAnswer(answersGiven[currentQuestion]),e==JSON.parse(quiz.questions).length-1&&$(".submitAnswersButtonHeader").hide()}function previousQuestion(e){answersGiven[e]=selectedAnswer,selectedAnswer=-1,$(".selectedAnswer").removeClass("selectedAnswer"),$(".questionContainer."+e).removeClass("currentQuestion"),$(".questionContainer."+(e-1)).addClass("currentQuestion"),$(".footer-button."+e).hide(),$(".footer-button."+(e-1)).show(),currentQuestion-=1,updateQuizFooterQuestionColours(),selectAnswer(answersGiven[currentQuestion])}function skipQuestion(e){selectedAnswer=-1,$(".selectedAnswer").removeClass("selectedAnswer"),$(".questionContainer."+e).removeClass("currentQuestion"),$(".questionContainer."+(e+1)).addClass("currentQuestion"),currentQuestion+=1,updateQuizFooterQuestionColours()}function goToQuestionReview(e){$("#quizReview").hide(),goToQuestion(e)}function goToQuestion(e){$(".currentQuestion").removeClass("currentQuestion"),$(".questionContainer."+e).addClass("currentQuestion"),$(".footer-button").hide(),$(".footer-button."+e).show(),currentQuestion=e,updateQuizFooterQuestionColours(),selectAnswer(answersGiven[currentQuestion]),e!=JSON.parse(quiz.questions).length&&$(".submitAnswersButtonHeader").show()}function updateQuizFooterQuestionColours(){var e="#ffbbbb",t="#bbffc0";answersGiven.forEach(function(s,i){currentQuestion>i&&-1==s?$(".questionButton."+i+" button").css("backgroundColor",e):-1!=s&&$(".questionButton."+i+" button").css("backgroundColor",t)})}function newFilledArray(e,t){for(var s=new Array(e);--e>=0;)s[e]=t;return s}function updateCountdownTimers(){var e=Math.floor(moment(quiz.endTime).diff(moment())/1e3);$(".timer").text(pad(e,2))}var quiz,selectedAnswer,answersGiven,startQuizTime,endQuizTime,endTimer,endTimeMoment,timeLeftTimer,currentQuestion=0,count,counter;window.onload=function(){$.post("./php/quizzes/getquizinfo.php",{id:sessionStorage.quizID},function(e){"success"==e[0]?(quiz=e[1],answersGiven=newFilledArray(JSON.parse(quiz.questions).length,-1),createQuestions(),startQuiz()):displayMessage("error","Error","Error: "+e[1])},"json").fail(function(){}),disableCopying()};
